# ============================================
# CONFIGURAÇÃO SUPABASE - SEGURANÇA CRÍTICA
# ============================================
# 
#  ATENÇÃO: O Supabase possui DUAS chaves diferentes:
#
# 1. ANON KEY (Chave Pública) - SEGURA para usar no frontend
#    - Pode ser exposta no código do cliente
#    - Protegida por Row Level Security (RLS) no banco
#    - Use esta chave no frontend (VITE_SUPABASE_ANON_KEY)
#
# 2. SERVICE_ROLE KEY (Chave Privada) - NUNCA use no frontend!
#    -  NUNCA adicione esta chave em arquivos .env do frontend
#    -  NUNCA commite esta chave no Git
#    -  Use APENAS em backends/APIs server-side
#    - Bypassa todas as políticas RLS - acesso total ao banco
#
# ============================================

# Supabase Configuration (Frontend - SEGURO)
# Use APENAS a ANON KEY aqui - esta chave é segura para frontend
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key-here

# ============================================
# CI/CD (GitHub Actions) / SERVER-SIDE (NÃO USAR NO FRONTEND)
# ============================================
# Usado pelo workflow `.github/workflows/deploy-functions.yml` para chamar
# as Edge Functions de migrations via HTTP (run-migrations*).
# Configure estes valores como secrets no GitHub (Actions Secrets).
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_DB_PASSWORD=your-db-password-here

#  NÃO ADICIONE SERVICE_ROLE_KEY AQUI!
# A service_role_key deve ser usada APENAS em:
# - Backend APIs (NestJS, Fastify, etc.)
# - Serverless Functions
# - Scripts de migração/deploy
# - NUNCA no frontend React/Vite

# ============================================
# CONFIGURAÇÃO N8N
# ============================================

# n8n Configuration
# URL da instância do n8n (pode ser self-hosted ou cloud)
VITE_N8N_URL=https://your-n8n-instance.com
VITE_N8N_API_KEY=your-n8n-api-key-here
# Opcional: Webhook URL base para receber eventos do n8n
VITE_N8N_WEBHOOK_URL=https://your-n8n-instance.com/webhook

# ============================================
# DESENVOLVIMENTO LOCAL (Opcional)
# ============================================
# VITE_API_URL=http://localhost:3001
# VITE_SKIP_DB_CHECK=true
# Quando true, o frontend pula a checagem de banco (útil em ambientes sem DB/config completo)

# ============================================
# CONFIGURAÇÃO CONTA AZUL
# ============================================
# URL de retornos de callbacks (Redirecionamento OAuth)
# Deve incluir o hash (#) se usar HashRouter
# Dev: http://localhost:5173/auth/conta-azul/callback
# Prod: https://seu-dominio.com/auth/conta-azul/callback
VITE_CONTA_AZUL_REDIRECT_URI=http://localhost:5173/auth/conta-azul/callback

# ============================================
# EDGE FUNCTIONS - SECRETS (SUPABASE DASHBOARD)
# ============================================
# IMPORTANTE: Estas variáveis devem ser configuradas no Supabase Dashboard
# (Settings > Edge Functions > Secrets), NÃO no arquivo .env local.
#
# As Edge Functions buscam as credenciais nesta ordem:
# 1. Banco de dados (app_core.app_config) - via RPC get_conta_azul_client_id/secret
# 2. Variáveis de ambiente (secrets do Supabase)
#
# Nomes aceitos para variáveis de ambiente (ambas as convenções funcionam):
# - CA_CLIENT_ID / CA_CLIENT_SECRET (preferencial)
# - CONTA_AZUL_CLIENT_ID / CONTA_AZUL_CLIENT_SECRET (alternativa)
#
# Para configurar no Supabase Dashboard:
# 1. Acesse: https://supabase.com/dashboard/project/[seu-project]/settings/functions
# 2. Adicione os secrets:
#    - CA_CLIENT_ID: seu-client-id-aqui
#    - CA_CLIENT_SECRET: seu-client-secret-aqui
#    - SYSTEM_API_KEY: sua-api-key-aqui (opcional, para get-valid-token)
#
# NOTA: As credenciais são automaticamente salvas no banco durante o setup
# (via run-migrations), então as variáveis de ambiente são apenas um fallback.
